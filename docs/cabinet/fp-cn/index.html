



<!DOCTYPE HTML>
<html lang="en-US">
<head>
<title>  </title>
<link href="https://fonts.googleapis.com/css?family=Neuton|Merriweather:300|Roboto+Mono" rel="stylesheet">
<style>
  .nav-button {
    display: inline;
    overflow-x: auto;
    font-size: 95%;
    font-family: 'Merriweather', serif;
  }
  p, .ul, .ol, .footnotes, li {
    max-width: 35em;
    font-size: 92%;
    line-height: 145%;
    font-family: 'Merriweather', serif;
  }
  h1, h2, h3, h4, h5, h6 {
    margin: 0px;
    font-family: 'Neuton', serif;
  }
  code {
    font-family: 'Roboto Mono';
  }

</style>

</head>
<body>


<h2>  </h2>

<hr>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frequentist Persuasion — c_N(z)</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500&family=Crimson+Pro:ital,wght@0,300;0,400;1,300;1,400&display=swap');

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg:      #08080f;
  --surface: #10101c;
  --border:  #252540;
  --border2: #353558;
  --text:    #e4e4f0;
  --dim:     #8080a8;
  --faint:   #404068;
  --amber:   #f2a600;
  --blue:    #4da6ff;
}

html, body { height: 100%; }
body {
  background: var(--bg);
  color: var(--text);
  font-family: 'Crimson Pro', Georgia, serif;
  display: flex;
  flex-direction: column;
}

header {
  padding: 18px 36px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: baseline;
  gap: 16px;
  flex-shrink: 0;
}
.header-title {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.75rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: var(--dim);
}
.header-sub { font-size: 1rem; color: var(--dim); font-style: italic; }

.layout { flex: 1; display: flex; min-height: 0; }

.sidebar {
  width: 240px;
  flex-shrink: 0;
  border-right: 1px solid var(--border);
  padding: 24px 22px;
  display: flex;
  flex-direction: column;
  gap: 22px;
  overflow-y: auto;
}
.section-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.6rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--faint);
  margin-bottom: 10px;
}
.param { display: flex; flex-direction: column; gap: 6px; }
.param-header { display: flex; justify-content: space-between; align-items: baseline; }
.param-name { font-family: 'JetBrains Mono', monospace; font-size: 0.82rem; color: var(--dim); }
.param-val  { font-family: 'JetBrains Mono', monospace; font-size: 1rem; color: var(--text); }
input[type=range] {
  -webkit-appearance: none;
  width: 100%; height: 3px;
  background: var(--border2);
  border-radius: 2px; outline: none;
}
input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 14px; height: 14px;
  border-radius: 50%;
  background: var(--amber);
  cursor: pointer;
}
.param-desc { font-size: 0.8rem; color: var(--faint); font-style: italic; line-height: 1.4; }

.stat-row { display: flex; flex-direction: column; gap: 3px; }
.stat-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.6rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: var(--faint);
}
.stat-value { font-family: 'JetBrains Mono', monospace; font-size: 1rem; color: var(--text); }
.stat-value.amber { color: var(--amber); }

hr { border: none; border-top: 1px solid var(--border); }

.main {
  flex: 1; min-width: 0;
  display: flex; flex-direction: column;
  padding: 28px 36px 24px;
  gap: 16px;
}
.chart-title {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.6rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: var(--faint);
  flex-shrink: 0;
}
.canvas-wrap { flex: 1; min-height: 0; }
canvas { display: block; width: 100%; height: 100%; }
</style>
</head>
<body>

<header>
  <span class="header-title">Frequentist Persuasion</span>
  <span class="header-sub">c_N(z) · π(z) · V_N(z) as functions of lying probability</span>
</header>

<div class="layout">
  <div class="sidebar">
    <div>
      <div class="section-label">Parameters</div>
      <div style="display:flex;flex-direction:column;gap:16px">

        <div class="param">
          <div class="param-header">
            <span class="param-name">μ₀ = Pr[guilty]</span>
            <span class="param-val" id="mu0Val">0.30</span>
          </div>
          <input type="range" id="mu0Slider" min="0.05" max="0.95" step="0.01" value="0.30" oninput="onParam()">
        </div>

        <div class="param">
          <div class="param-header">
            <span class="param-name">N  (sample size)</span>
            <span class="param-val" id="nVal">20</span>
          </div>
          <input type="range" id="nSlider" min="1" max="500" step="1" value="20" oninput="onParam()">
        </div>

      </div>
    </div>

    <hr>

    <div>
      <div class="section-label">Benchmarks</div>
      <div style="display:flex;flex-direction:column;gap:14px">

        <div class="stat-row">
          <div class="stat-label">z^KG</div>
          <div class="stat-value amber" id="zKGVal">—</div>
          <div class="param-desc" style="margin-top:2px">μ₀ / (1−μ₀) · limit of z*(N)</div>
        </div>

        <div class="stat-row">
          <div class="stat-label">c_N(z^KG)</div>
          <div class="stat-value" id="cAtZKGVal">—</div>
          <div class="param-desc" style="margin-top:2px">converges to ½ from above</div>
        </div>

      </div>
    </div>

  </div>

  <div class="main">
    <div class="chart-title">c_N(z) = Pr[convict] · faint = π(z) = Pr[m=guilty]</div>
    <div class="canvas-wrap" style="flex:1">
      <canvas id="chartC"></canvas>
    </div>
    <div class="chart-title" style="margin-top:10px">V_N(z) = π(z) · c_N(z) — prosecutor value</div>
    <div class="canvas-wrap" style="flex:1">
      <canvas id="chartV"></canvas>
    </div>
  </div>
</div>

<script>
/* ════════════════════════════════════════════════════════════════
   MATH
   ════════════════════════════════════════════════════════════════

   c_N(z) = Pr[X ≥ Y, X+Y > 0]  where (X,Y,Z) ~ Multinomial(N; pX, pY, pZ)
     pX = μ₀,  pY = (1−μ₀)·z,  pZ = (1−μ₀)·(1−z)

   Computed by direct summation over (x,y) pairs, using log-space PMF.

   Asymptotic behaviour as N → ∞:
     z < z^KG  →  c_N(z) → 1     (posterior concentrates above ½)
     z = z^KG  →  c_N(z) → ½     (posterior concentrates at ½ exactly)
     z > z^KG  →  c_N(z) → 0     (posterior concentrates below ½)

   where z^KG = μ₀ / (1−μ₀).

   ════════════════════════════════════════════════════════════════ */

/* ── Log-factorial table: LF[n] = log(n!) for n = 0..500 ── */
const LF = new Array(501);
LF[0] = 0;
for (let i = 1; i <= 500; i++) LF[i] = LF[i - 1] + Math.log(i);

const LOG_THRESH = -23;  // exp(-23) ≈ 1e-10, skip negligible terms

/* ── c_N(z): sum multinomial PMF over x ≥ y, x+y > 0 ── */
function cN(z, mu0, N) {
  if (z < 1e-9) {
    // z=0: pY=0, so Y=0 always. Convict iff X > 0, i.e. not all-Z.
    return 1 - Math.pow(1 - mu0, N);
  }
  const pX = mu0;
  const pY = (1 - mu0) * z;
  const pZ = (1 - mu0) * (1 - z);
  const logPX = Math.log(pX + 1e-300);
  const logPY = Math.log(pY + 1e-300);
  const logPZ = Math.log(pZ + 1e-300);
  let c = 0;
  for (let x = 0; x <= N; x++) {
    for (let y = 0; y <= N - x; y++) {
      if (x + y === 0) continue;
      if (x < y)       continue;
      const zz   = N - x - y;
      const logP = LF[N] - LF[x] - LF[y] - LF[zz]
                 + x * logPX + y * logPY + zz * logPZ;
      if (logP < LOG_THRESH) continue;
      c += Math.exp(logP);
    }
  }
  return c;
}

/* ════════════════════════════════════════════════════════════════
   STATE
   ════════════════════════════════════════════════════════════════ */
let mu0 = 0.30;
let N   = 20;

/* ════════════════════════════════════════════════════════════════
   SHARED CANVAS SETUP HELPER
   ════════════════════════════════════════════════════════════════ */
function setupCanvas(id) {
  const canvas = document.getElementById(id);
  const W = canvas.clientWidth, H = canvas.clientHeight;
  if (!W || !H) return null;
  canvas.width  = W * devicePixelRatio;
  canvas.height = H * devicePixelRatio;
  const ctx = canvas.getContext('2d');
  ctx.scale(devicePixelRatio, devicePixelRatio);
  return { canvas, ctx, W, H };
}

function drawFrame(ctx, W, H, ml, mr, mt, mb) {
  const pw = W - ml - mr, ph = H - mt - mb;
  const xp = z => ml + z * pw;
  const zKG = Math.min(mu0 / (1 - mu0), 1);

  /* Background */
  ctx.fillStyle = '#08080f';
  ctx.fillRect(0, 0, W, H);

  /* Shaded regions around z^KG */
  ctx.fillStyle = 'rgba(242,166,0,0.035)';
  ctx.fillRect(ml, mt, xp(zKG) - ml, ph);
  ctx.fillStyle = 'rgba(77,166,255,0.035)';
  ctx.fillRect(xp(zKG), mt, ml + pw - xp(zKG), ph);

  /* Grid */
  [0, 0.25, 0.5, 0.75, 1.0].forEach(v => {
    ctx.strokeStyle = '#252540'; ctx.lineWidth = 1;
    ctx.beginPath(); ctx.moveTo(ml, mt + ph*(1-v)); ctx.lineTo(ml+pw, mt + ph*(1-v)); ctx.stroke();
    ctx.fillStyle = '#404068'; ctx.font = '11px JetBrains Mono, monospace'; ctx.textAlign = 'right';
    ctx.fillText(v.toFixed(2), ml - 8, mt + ph*(1-v) + 4);
    ctx.beginPath(); ctx.moveTo(xp(v), mt+ph); ctx.lineTo(xp(v), mt+ph+5); ctx.stroke();
    ctx.fillStyle = '#404068'; ctx.textAlign = 'center';
    ctx.fillText(v.toFixed(2), xp(v), mt+ph+18);
  });

  /* z^KG line */
  ctx.save();
  ctx.setLineDash([6,4]);
  ctx.strokeStyle = '#f2a600'; ctx.lineWidth = 1.5; ctx.globalAlpha = 0.45;
  ctx.beginPath(); ctx.moveTo(xp(zKG), mt); ctx.lineTo(xp(zKG), mt+ph); ctx.stroke();
  ctx.restore();
  ctx.fillStyle = '#f2a600'; ctx.globalAlpha = 0.7;
  ctx.font = 'italic 10px JetBrains Mono, monospace'; ctx.textAlign = 'center';
  ctx.fillText('z^KG', xp(zKG), mt - 6);
  ctx.globalAlpha = 1;

  ctx.strokeStyle = '#404068'; ctx.lineWidth = 1;
  ctx.strokeRect(ml, mt, pw, ph);

  return pw, ph;  // ignored; caller uses pw/ph from closure
}

/* ════════════════════════════════════════════════════════════════
   DRAW — top pane: c_N(z) with faint π(z) overlay
   ════════════════════════════════════════════════════════════════ */
function drawC(pts) {
  const s = setupCanvas('chartC');
  if (!s) return;
  const { ctx, W, H } = s;
  const ml = 64, mr = 36, mt = 24, mb = 44;
  const pw = W - ml - mr, ph = H - mt - mb;
  const xp = z => ml + z * pw;
  const yp = v => mt + ph * (1 - v);   // v in [0,1]
  const zKG = Math.min(mu0 / (1 - mu0), 1);

  drawFrame(ctx, W, H, ml, mr, mt, mb);

  /* ½ reference */
  ctx.save();
  ctx.setLineDash([4,4]);
  ctx.strokeStyle = '#404068'; ctx.lineWidth = 1;
  ctx.beginPath(); ctx.moveTo(ml, yp(0.5)); ctx.lineTo(ml+pw, yp(0.5)); ctx.stroke();
  ctx.restore();
  ctx.fillStyle = '#404068'; ctx.font = '10px JetBrains Mono, monospace';
  ctx.textAlign = 'left';
  ctx.fillText('½', ml+pw+6, yp(0.5)+4);

  /* π(z) = μ₀ + (1−μ₀)·z — faint background line */
  ctx.beginPath();
  for (let i = 0; i <= 100; i++) {
    const z = i / 100;
    const pi = mu0 + (1 - mu0) * z;
    i === 0 ? ctx.moveTo(xp(z), yp(pi)) : ctx.lineTo(xp(z), yp(pi));
  }
  ctx.strokeStyle = '#8080a8'; ctx.lineWidth = 1.5;
  ctx.lineJoin = 'round'; ctx.globalAlpha = 0.3; ctx.stroke();
  ctx.globalAlpha = 1;
  /* label */
  ctx.fillStyle = '#8080a8'; ctx.globalAlpha = 0.5;
  ctx.font = 'italic 10px JetBrains Mono, monospace'; ctx.textAlign = 'left';
  ctx.fillText('π(z)', xp(0.7), yp(mu0 + (1-mu0)*0.7) - 8);
  ctx.globalAlpha = 1;

  /* c_N(z) curve */
  ctx.beginPath();
  pts.forEach((p, i) => i === 0 ? ctx.moveTo(xp(p.z), yp(p.c)) : ctx.lineTo(xp(p.z), yp(p.c)));
  ctx.strokeStyle = '#e4e4f0'; ctx.lineWidth = 2.2;
  ctx.lineJoin = 'round'; ctx.globalAlpha = 0.85; ctx.stroke();
  ctx.globalAlpha = 1;

  /* Dot at z^KG */
  const cAtZKG = cN(zKG, mu0, N);
  ctx.beginPath(); ctx.arc(xp(zKG), yp(cAtZKG), 4.5, 0, Math.PI*2);
  ctx.fillStyle = '#f2a600'; ctx.fill();
  ctx.strokeStyle = '#08080f'; ctx.lineWidth = 1.5; ctx.stroke();

  /* Axis labels */
  ctx.fillStyle = '#8080a8'; ctx.font = '12px JetBrains Mono, monospace'; ctx.textAlign = 'center';
  ctx.fillText('z  (lying probability)', ml + pw/2, H - 8);
  ctx.save();
  ctx.translate(14, mt + ph/2); ctx.rotate(-Math.PI/2);
  ctx.fillText('c_N(z)', 0, 0);
  ctx.restore();
}

/* ════════════════════════════════════════════════════════════════
   DRAW — bottom pane: V_N(z) = π(z) · c_N(z)
   ════════════════════════════════════════════════════════════════ */
function drawV(pts) {
  const s = setupCanvas('chartV');
  if (!s) return;
  const { ctx, W, H } = s;
  const ml = 64, mr = 36, mt = 24, mb = 44;
  const pw = W - ml - mr, ph = H - mt - mb;
  const xp = z => ml + z * pw;
  const zKG = Math.min(mu0 / (1 - mu0), 1);

  /* V_N(z) range: max is at most 1 (π ≤ 1, c ≤ 1) but realistically ≤ μ₀+ε */
  const vMax = Math.max(...pts.map(p => p.v), 0.01);
  /* Fix y-scale to a round ceiling so it doesn't jump around */
  const yCeil = Math.min(1, Math.ceil(vMax * 10) / 10 + 0.05);
  const yp = v => mt + ph * (1 - v / yCeil);

  drawFrame(ctx, W, H, ml, mr, mt, mb);

  /* Rewrite y-axis labels using yCeil scale */
  ctx.fillStyle = '#08080f';
  ctx.fillRect(0, mt, ml - 1, ph);  // clear default labels from drawFrame
  [0, 0.25, 0.5, 0.75, 1.0].forEach(frac => {
    const v = frac * yCeil;
    ctx.fillStyle = '#404068'; ctx.font = '11px JetBrains Mono, monospace'; ctx.textAlign = 'right';
    ctx.fillText(v.toFixed(2), ml - 8, yp(v) + 4);
  });

  /* z*(N) — the argmax — mark with a dot */
  const vBest = pts.reduce((best, p) => p.v > best.v ? p : best, pts[0]);

  /* V_N(z) curve */
  ctx.beginPath();
  pts.forEach((p, i) => i === 0 ? ctx.moveTo(xp(p.z), yp(p.v)) : ctx.lineTo(xp(p.z), yp(p.v)));
  ctx.strokeStyle = '#4ecb8a'; ctx.lineWidth = 2.2;
  ctx.lineJoin = 'round'; ctx.globalAlpha = 0.85; ctx.stroke();
  ctx.globalAlpha = 1;

  /* Dot at optimum z*(N) */
  ctx.beginPath(); ctx.arc(xp(vBest.z), yp(vBest.v), 4.5, 0, Math.PI*2);
  ctx.fillStyle = '#4ecb8a'; ctx.fill();
  ctx.strokeStyle = '#08080f'; ctx.lineWidth = 1.5; ctx.stroke();
  /* label */
  ctx.fillStyle = '#4ecb8a'; ctx.globalAlpha = 0.8;
  ctx.font = '10px JetBrains Mono, monospace'; ctx.textAlign = 'center';
  ctx.fillText('z*(N) ≈ ' + vBest.z.toFixed(2), xp(vBest.z), yp(vBest.v) - 10);
  ctx.globalAlpha = 1;

  /* Axis labels */
  ctx.fillStyle = '#8080a8'; ctx.font = '12px JetBrains Mono, monospace'; ctx.textAlign = 'center';
  ctx.fillText('z  (lying probability)', ml + pw/2, H - 8);
  ctx.save();
  ctx.translate(14, mt + ph/2); ctx.rotate(-Math.PI/2);
  ctx.fillText('V_N(z)', 0, 0);
  ctx.restore();

  /* Update sidebar stats */
  document.getElementById('zKGVal').textContent    = zKG.toFixed(4);
  document.getElementById('cAtZKGVal').textContent = cN(zKG, mu0, N).toFixed(4);
}

/* ════════════════════════════════════════════════════════════════
   DRAW — top level
   ════════════════════════════════════════════════════════════════ */
function draw() {
  const nSteps = 120;
  const pts = [];
  for (let i = 0; i <= nSteps; i++) {
    const z  = i / nSteps;
    const pi = mu0 + (1 - mu0) * z;
    const c  = cN(z, mu0, N);
    pts.push({ z, pi, c, v: pi * c });
  }
  drawC(pts);
  drawV(pts);
}

/* ════════════════════════════════════════════════════════════════
   CONTROLS
   ════════════════════════════════════════════════════════════════ */
let debounceTimer = null;

function onParam() {
  mu0 = parseFloat(document.getElementById('mu0Slider').value);
  N   = parseInt(document.getElementById('nSlider').value);
  document.getElementById('mu0Val').textContent = mu0.toFixed(2);
  document.getElementById('nVal').textContent   = N;
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(draw, N > 100 ? 120 : 0);
}

window.addEventListener('resize', draw);
window.addEventListener('load', draw);
</script>
</body>
</html>




<hr>
<footer>
  <div class="nav-button">
    <a href="/">Home</a>
  </div>
  
  <div class="nav-button">
    <a href="https://github.com/arnavs">GitHub</a>
  </div>
  <div class="nav-button">
    <a href="/research">Research and Simulations</a>
  </div>
  <div class="nav-button">
    <a href="https://arnavs.github.io/resume/sood-cv_full.pdf" target="_blank">CV</a>
  </div>
  <div class="nav-button">
    <a href="/writing">Writing</a>
  </div>
  <div class="nav-button">
    <a href="/links">Links</a>
  </div>
  <div class="nav-button">
    <a href="/hikes">Hikes</a>
  </div>
  <div class="nav-button">
    <a href="https://jianingzhao.com">Wife</a>
  </div>
</footer>
</body>

</html>
